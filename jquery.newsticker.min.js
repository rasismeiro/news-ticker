(function(a){a.newsTicker=function(b){this.defaults={animateSpeed:10000,animateCategorySpeed:300,category:"#news_category",link:"#news_links"};this.timer=null;this.selected=null;this.selectedCatID=null;this.total=null;this.categories=new Array();this.links=new Array();this.linksWidth=null;this.defaults=a.extend({},this.defaults,b);this.time=(this.defaults.animateSpeed+this.defaults.animateCategorySpeed+30);this.height=parseInt(a(this.defaults.category+" li").first().height(),10);this.loadCategories=function(){var g=0,h,e,f,d=this;this.categories=new Array();a(this.defaults.category+" li").each(function(i,c){h=new Array();e=a(c);h.id=e.attr("id");f=e.attr("class");if("undefined"!==typeof(f)){h["class"]=f}else{h["class"]=""}h.html=e.html();if(typeof(d.categories[h.id])==="undefined"){h.index=g++;d.categories[h.id]=h}})};this.loadLinks=function(){var e,f,d=0,c=this;this.links=new Array();a(this.defaults.link+" li").each(function(h,g){e=new Array();f=a(g);e.html=f.html();e.target=f.data("target");e.width=f.width();e["class"]=f.attr("class");if("undefined"===typeof(e["class"])){e["class"]=""}c.links[d]=e;d++});this.linksWidth=a(this.defaults.link).width();this.selected=0;this.total=a(this.links).length;this.selectedCatID=this.categories[this.links[0]["target"]]["id"]};this.start=function(){var c,d,e=this;this.loadCategories();this.loadLinks();d=this.links[0];c=d.target;a(this.defaults.category).html('<li id="'+this.selectedCatID+'" class="'+this.categories[c]["class"]+'">'+this.categories[c]["html"]+"</li>");a(this.defaults.link).html('<li data-target="'+d.target+'" class="'+d["class"]+'">'+d.html+"</li>");a(this.defaults.link+" li").first().css({width:d.width+"px",marginLeft:(this.linksWidth+10)+"px"});this.timer=setInterval(function(){e.run()},this.time);a(this.defaults.link+" li").first().animate({marginLeft:"-"+(d.width+10)+"px"},this.defaults.animateSpeed,"linear",function(){})};this.moveCategory=function(c,e){var d=this;if(this.selectedCatID!==c){this.height=parseInt(a(this.defaults.category+" li").first().height(),10);a(this.defaults.category).append(a('<li id="'+this.categories[c]["id"]+'" class="'+this.categories[c]["class"]+'">'+this.categories[c]["html"]+"</li>"));a("#"+this.selectedCatID).animate({marginTop:"-"+this.height+"px"},this.defaults.animateCategorySpeed,function(){a("#"+d.selectedCatID).remove();d.selectedCatID=c;if("function"===typeof(e)){e()}})}else{if("function"===typeof(e)){e()}}};this.run=function(){var c=this.selected+1,d,e=this;if(c>(this.total-1)){c=0}d=this.links[c];a(this.defaults.link+" li").remove();this.moveCategory(d.target,function(){a(e.defaults.link).html(a('<li data-target="'+d.target+'" class="'+d["class"]+'">'+d.html+"</li>").css({width:d.width+"px",marginLeft:(e.linksWidth+10)+"px"}));a(e.defaults.link+" li").first().animate({marginLeft:"-"+(d.width+10)+"px"},e.defaults.animateSpeed,"linear",function(){e.selected=c})})};this.stop=function(){clearInterval(this.timer)};this.start()}})(jQuery);
